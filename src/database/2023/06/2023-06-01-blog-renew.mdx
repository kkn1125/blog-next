---
slug: "/blog-renew/"
date: 2023-06-01 02:36:27 +0000
modified: 2023-06-01 02:36:27 +0000
title: "[NEXT.JS] 블로그 UI 변경"
author: Kimson
categories: [javascript]
image: /assets/images/post/covers/TIL-next.png
tags: [blog, next.js, migration]
description: "새로운 블로그

이번에는 블로그 환경을 변경한 작업에 대해 정리해서 포스팅하고자 합니다. 블로그 포스팅도 그렇고 관리가 너무 소홀했던 것 같아 매우 아쉽습니다.

기존에 사용하던 Gatsby에서 Next.js로 변경한 계기와 이유에 대해서 짧게 적고자 합니다.

초기 블로그 세팅은 jekyll로 시작했습니다. jekyll로 블로그를 구성하는데 수많은 템플릿이 있기 때문에 UI를 커스터마이징 하는데 수월했습니다. 괜찮은 템플릿 하나 구해서 조금만 수정하면 제 것으로 만들 수 있으니까요. 그런데 jekyll을 사용하면서 느낀 불편함은 포스팅 수가 많아질수록 로딩, 리로딩, 빌드가 매우 느려지는 단점이 있었습니다.

물론 최적화에 대한 깊이가 없어 발생한 저만의 문제 일 수 있습니다. 때문에 Gatsby로 변경하게 되었지요."
featured: true
rating: 4.5
profile: false
published: true
---

# 새로운 블로그

이번에는 블로그 환경을 변경한 작업에 대해 정리해서 포스팅하고자 합니다. 블로그 포스팅도 그렇고 관리가 너무 소홀했던 것 같아 매우 아쉽습니다.

기존에 사용하던 Gatsby에서 Next.js로 변경한 계기와 이유에 대해서 짧게 적고자 합니다.

초기 블로그 세팅은 jekyll로 시작했습니다. jekyll로 블로그를 구성하는데 수많은 템플릿이 있기 때문에 UI를 커스터마이징 하는데 수월했습니다. 괜찮은 템플릿 하나 구해서 조금만 수정하면 제 것으로 만들 수 있으니까요. 그런데 jekyll을 사용하면서 느낀 불편함은 포스팅 수가 많아질수록 로딩, 리로딩, 빌드가 매우 느려지는 단점이 있었습니다.

물론 최적화에 대한 깊이가 없어 발생한 저만의 문제 일 수 있습니다. 때문에 Gatsby로 변경하게 되었지요.

## Gatsby의 개발환경

Gatsby는 정적 사이트를 빌드하는데 편리한 기능을 제공합니다. graphql을 통해 포스팅 frontmatter를 생성하고 각 포스팅을 불러오는 데이터를 커스터마이징해서 원하는 정보를 출력하는 등 관리하는데 좋다고 생각했습니다.

그런데 한 가지 잊고 있던 사실이 jekyll때 처럼 포스팅 수가 많아질수록 로딩 속도와 리로딩(hmr) 속도가 눈에 띄게 느려졌습니다. jekyll과 다른 점은 빌드속도는 여전히 빠르다는 것입니다.

빌드속도는 Gatsby가 매우 빠르다는 것을 Next.js로 변경하고나서 느꼈습니다.

## Next.js 개발환경

Next.js는 React 기반의 서버사이드 렌더링 및 정적 웹 앱 개발을 위한 javascript 프레임워크입니다. Next.js로 변경하면서 Gatsby와 다르게 SEO를 수정하기 편한 점이 마음에 들었습니다. sitemap을 생성하는 방식도 Gatsby의 경우 플러그인을 사용해서 생성하게 되는데, 개인적으로 커스터마이징하는 방법이 불편했습니다.

잘 못 만든 것은 아닙니다. 분명히 라이브러리나 플러그인 등을 만들고 난 후 사용법에 대한 난이도는 분명 존재합니다.

로딩 속도와 리로딩 속도는 Next.js가 매우 빠르다고 느꼈습니다. 성능이 좋지 않은 필자의 노트북으로 실행해도 꽤 빠르다는 것을 체감했습니다.

최적화 설정이 있지만 굳이 해주지 않아도 빠르다면 마다할 이유가 없다고 생각했습니다. 포스트 파일(.md)을 모두 옮겨와 이번에 알게된 mdx로 변경하여 빌드까지 테스트를 해보니 hmr은 지킬과 개츠비, Next.js를 놓고 비교해 봤을때 로딩 부문은 Next.js가 가장 빠르다고 느꼈습니다. 커스터마이징 면에서 쉬운 조작과 간편한 설정은 Next.js라고 생각됩니다.

빌드 면에서는 jekyll과 Next.js를 제치고 Gatsby가 빠르다고 생각합니다. Next.js에서 다 좋은데 빌드 속도만큼은 조금 아쉽다고 생각이 됩니다.

> 어렵게 사용하느냐 쉽게 사용하느냐를 보고 필자는 판단하기 때문에 주관적 의견임을 알립니다.

## 블로그 변경 이슈

블로그 환경을 변경할 때 고려할만한 사항을 정리해보려합니다. 환경을 자주 변경하는 편은 아니지만 벌써 초기 spring boot기반 블로그에서 현재 Next.js까지 4차례 변경이 있었기 때문에 아니라고는 또 말 못하겠네요... 😊

1. 포스트 파일 확장자가 md 또는 mdx 파일인지?
2. 포스트 파일의 메타데이터 (frontmatter)가 모든 파일 별로 동일한 포멧인지?
3. UI에 자신이 없다면 샘플 자료는 충분하게 확보했는지?
4. 변경하고자 하는 개발 환경의 프레임워크가 충분히 내가 처한 상황과 이슈에 대응 가능한지?
5. 포스트 파일 내에 html 태그를 사용한 부분과 태그의 속성을 작성한 부분이 있는지?

### 포스트 확장자

위 항목은 제가 겪었던 이슈를 함축해서 요약한 것입니다. 더 많은 이슈가 있었지만 대표적으로 저를 힘들게 했던 이슈인데요. 하나 씩 이야기하고자 합니다.

먼저, 포스트 파일 확장자 이슈가 큰 문제는 아니지만 손이 많이 갈수도 있다고 생각합니다. 포스트 파일이 몇 개 안된다면 크게 번거롭지는 않지만 파일 개수가 100 ~ 200 개 넘어간다면 포스트 파일 확장자를 명확하게 유지해나가는게 좋다고 생각합니다.

현재 필자가 올린 포스트 개수는 150개 가량됩니다. shell script를 아신다면 이 모든 파일 확장자를 변경하는건 일이 아니지만 수고로운건 매한가지일 것 입니다.

### 포스트 메타데이터 포멧팅

이 부분이 매우 중요한 노가다 포인트가 될 수 있습니다. 포스트 메타데이터는 Gatsby나 jekyll처럼 특정 개발환경에서는 포스트 경로를 지정하기위해 고정된 필드 네임을 요구할 수 있습니다. 가령, `slug: /test01/` 처럼 `slug`라는 필드가 들어가야 할 수도 있고, 혹은 `path: /test01/`로 들어가야할 수도 있지요.

때문에 환경을 변경하고자 할 때 우선적으로 검토해야할 부분 중에 하나라고 말씀드리고 싶네요.

### 레퍼런스 찾기

아파트 설계를 하면서 건물 디자인은 해봤어도 웹 페이지 디자인을 해본 적이 없기 때문에 경험자가 만들어 둔 이쁜 샘플을 보고 레이아웃을 짜고 저작권 상 문제 될 수 있는 세부적인 디자인과 컴포넌트, 폰트는 따로 필자의 스타일에 맞게 변경했습니다.

건축을 할 때도 그렇고, 그림을 그릴 때도 그렇고 샘플이 없다면 처음 시작하는 단계에서 프랑켄슈타인을 만들수도 있기 때문에 개인적으로 샘플은 꼭 필요하다고 생각합니다.

그러기에 똥눈은 오늘도 샘플링을 합니다.

### 라이브러리 선택

개인 취향과 개발하고자 하는 방향에 따라 다를 수 있습니다. "누군가의 글을 보고 이 프레임워크를 선택했어!" 라고 한다면 단호하게 그런 사고방식을 고쳐야한다고 말씀드리고 싶습니다.

모든 선택에는 이유가 따르는 법입니다. "누군가의 글을 읽어보니 이 프레임워크가 어떤 면에서 내가 처한 상황을 보다 효율적으로 해결하고, 이러한 부분 때문에 프레임워크를 선택했어" 라고 말하는 편이 오히려 설득력이 있겠지요. 암묵적으로 사람들은 상대방의 말에 설득력이 있는지 판별합니다. 하지만 무의식적으로 의문이 생기거나 뭔가 충분한 이유같지 않다면 설득력이 부족할 수 있는 부분이지요.

그러한 점에서 보면, 개발 환경을 변경하고자 한다면 어떤 프레임워크가 자신이 처한 상황과 이슈를 보다 효율적으로 해결해 줄 수 있는지, 혹은 어떤 프레임워크가 사용하기 편하고 이해하기 쉬운지를 검토해보고 선택하는 것을 추천드리고자 합니다.

라이브러리 하나를 쓸 때도 얼마나 인기가 있고, 얼마나 많이 사용하며, 언제 업데이트가 되고, 지금도 개발이 활발한지를 따져보는 것처럼 말이지요.

라이브러리도 좋은 기능이라고 덥석 썼다가 개발중단되거나 이상한 개발방향으로 가서 호환이 안된다고 한다면 개인 프로젝트라면 상관없지만 협업을 하는 프로젝트의 입장에서는 빌런이 따로 없을 겁니다.

### 마크다운 빌런?

md파일 또는 mdx파일은 html태그를 포함에서 렌더링 가능합니다. 다만, 개발 환경에 따라서 빌런이 될수도, 고마운 존재가 될 수도 있지요.

md에서 mdx로 변경하면서 "와, 리액트 컴포넌트를 사용할 수 있다고?" 하면서 좋아했습니다. 그런데 작업하면서 느낀 것은 좋은 기능이라도 사용하지 못하겠다고 판단했습니다.

이유는 현재 mdx를 읽고 렌더링하는 설정과 추후 어느 환경으로 옮길지 모른다는 가정에 있어서 사용하지 않는 것인데요, 구체적으로 보자면 md파일로 다시 돌려야하는 상황이 생긴다면 몇 백개의 포스트 파일을 뒤져서 다시 mdx만의 기능을 제거하고 수정해야하는 상황이 벌어질 수 있다는 것에서 입니다.

또 다른 이유는 렌더링 방법에서 오는 한계입니다. Next.js에서 mdx를 import하는 기능을 지원하는데, 아래 처럼 생긴 내용을 아주 잘 렌더링 해줍니다.

```markdown
// test_post.mdx

import Layout from "./Layout";

// mdx내에서 사용할 변수
export const meta = {
slug: '/test01/',
title: 'test01',
description: '안녕 나는 포스트 내용이야.'
}

# 안녕

나는 포스트 내용이야.

<figure>
  <img src='https://abc.def/test.png' />
</figure>

export default ({ children }) => <Layout>{children}</Layout>;
```

하지만 외부의 mdx파일을 로드해서 뿌려야할 때는 `MDXRemote`라는 컴포넌트를 사용합니다. 이때 MDXRemote가 파싱하는 mdx파일의 결과물은 import, export를 인식못하고 모두 제거해버립니다. 물론 메타데이터도 사라집니다.

이 이슈를 해결하기 위해 md파일에서 메타데이터를 작성하는 방식을 적용하고 모든 import, export 구문을 제거합니다.

그 다음 이슈로는 html 태그의 영향인데요. 위의 예시로만 보면 별 문제가 없을 것으로 보이지만, class속성이나 대쉬 또는 합성어로 된 속성명일 때 리액트를 사용하는 면에서 보면 문제가 발생 할 수 있습니다.

대표적으로는 class를 className으로 표기해야하는 부분인데요. 이유는 추측하는 것이지만 mdx파일을 불러와 파싱하는 과정에서 리액트 컴포넌트로 파싱하는지 html로 파싱하는지 차이에서 발생하는 것이라 생각합니다.

현재 제가 사용하는 MDXRemote는 리액트 컴포넌트로 파싱하기 때문에 모든 `class`를 `className`으로 변경해야하는 일이 발생했습니다. 이전에 `Gatsby`에서 문제가 되지 않았던 이유는 동일하게 리액트를 사용하는데 md파일을 html로 파싱하기 때문에 굳이 `class`를 `className`으로 작성하지 않아도 되는 이유였지요.

```markdown
## // test_post.mdx

slug: /test01/
title: test01
description: '안녕 나는 포스트 내용이야.'

---

# 안녕

나는 포스트 내용이야.

![test](https://abc.def/test.png)
```

이렇게 해야 정상적으로 메타데이터를 읽고, 렌더링해줍니다. 간혹 `{:.title}` 와 같은 형태로 md파일에서 해당 라인에 클래스를 넣는 등의 표현식을 사용하는 라이브러리도 있습니다. 이렇게 작성한 포스트가 있다면 이 부분도 하나 씩 찾아서 변경해야하는 부분 중 하나가 되겠네요.

때에 따라서 변경이 필요한 부가기능이라면, 편의를 주지만 굳이 안해도 되는 기능이라면 md 또는 mdx만의 기본 기능에 충실하게 기본적으로 오류 없이 지원하는 문법과 표현식을 고수하는 편이 이후에도 좋을 것이라는 생각입니다.

## 마무리

이상 블로그 환경을 변경한 계기와 이유, 겪었던 이슈 사항을 정리했는데요. 혹시나 필자와 같은 상황으로 블로그 환경을 변경해야하는 필요를 느끼는 분이 있다면 어디까지나 참고만 하셔도 괜찮을 것 같다는 생각이 듭니다.

Next.js를 13버전 이전에 pages기반으로 배워놓고 손을 안대고 있던 터라 app디렉토리 기반은 아직 익숙하지가 않네요. 결국 pages 기반으로 설정했습니다. app기반으로 static export하기엔 여전히 stable하지는 않은 것 같습니다.

보시는 분들 모두 블로그 이쁘게 관리하시길 😊

---

📚 함께 보면 좋은 내용

[위키 - Cache](https://ko.wikipedia.org/wiki/%EC%BA%90%EC%8B%9C)

[위키 - Web Cache](https://ko.wikipedia.org/wiki/%EC%9B%B9_%EC%BA%90%EC%8B%9C)

[NPM - node-schedule](https://www.npmjs.com/package/node-schedule)
